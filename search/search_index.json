{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"PyEzTrace","text":"<p>     Dependency-free tracing, structured logs, and an interactive viewer for understanding real execution paths.   </p> Get Started Explore Usage"},{"location":"#why-teams-use-pyeztrace","title":"Why teams use PyEzTrace","text":"Hierarchical traces <p>Tree-style output makes nested execution paths readable without extra tooling.</p> Flexible log formats <p>Color, plain, JSON, CSV, and logfmt support one code path from local dev to production.</p> Runtime metrics <p>Collect timing data and context propagation details where latency and failures actually happen.</p> Interactive viewer <p>Inspect input/output previews, CPU, and memory from trace logs in a focused web UI.</p> <p>Note: The trace viewer UI (<code>pyeztrace serve</code>) is designed for local development and analysis\u2014it is not intended to be used as a hosted or production solution.</p>"},{"location":"#quick-start","title":"Quick start","text":"<pre><code>from pyeztrace.setup import Setup\nfrom pyeztrace import trace\nfrom pyeztrace.custom_logging import Logging\n\nSetup.initialize(\"MyApp\", show_metrics=True, log_format=\"json\", log_dir=\"logs\", log_file=\"app.log\")\nlog = Logging()\n\n@trace()\ndef process_order(order_id):\n    with log.with_context(order_id=order_id):\n        log.log_info(\"Processing order\")\n        # ... your code ...\n</code></pre> <p>Run your app, then open the trace viewer:</p> <pre><code>pyeztrace serve logs/app.log --host 127.0.0.1 --port 8765\n# open http://127.0.0.1:8765\n</code></pre>"},{"location":"#next-steps","title":"Next steps","text":"<ul> <li>Getting Started - Installation and initialization</li> <li>Usage - Tracing, context, formats, viewer, and async support</li> <li>Configuration - Environment variables and <code>Setup.initialize()</code> options</li> </ul>"},{"location":"configuration/","title":"Configuration","text":"<p>All options can be set via environment variables or code. Precedence: <code>Setup.initialize(...)</code> kwargs &gt; env vars &gt; defaults.</p>"},{"location":"configuration/#via-setupinitialize","title":"Via <code>Setup.initialize()</code>","text":"<p>Recommended for applications:</p> <pre><code>from pyeztrace.setup import Setup\n\nSetup.initialize(\n    \"MyApp\",\n    show_metrics=True,\n    disable_file_logging=False,\n    log_format=\"json\",\n    console_format=\"color\",\n    file_format=\"json\",\n    log_level=\"DEBUG\",\n    log_file=\"app.log\",\n    log_dir=\"logs\",\n    max_size=10 * 1024 * 1024,  # 10MB\n    backup_count=5,\n    buffer_enabled=False,\n    buffer_flush_interval=1.0,\n)\n</code></pre>"},{"location":"configuration/#via-environment-variables","title":"Via environment variables","text":"<pre><code>export EZTRACE_LOG_FORMAT=\"json\" # legacy: sets both console and file\nexport EZTRACE_CONSOLE_LOG_FORMAT=\"color\"\nexport EZTRACE_FILE_LOG_FORMAT=\"json\"\nexport EZTRACE_LOG_LEVEL=\"DEBUG\"\nexport EZTRACE_LOG_FILE=\"app.log\"\nexport EZTRACE_LOG_DIR=\"logs\"\nexport EZTRACE_MAX_SIZE=\"10485760\" # 10MB\nexport EZTRACE_BACKUP_COUNT=\"5\" # Keep 5 rotated files\nexport EZTRACE_DISABLE_FILE_LOGGING=\"0\"\nexport EZTRACE_BUFFER_ENABLED=\"false\" # Disable buffering by default (configurable via env)\nexport EZTRACE_BUFFER_FLUSH_INTERVAL=\"1.0\" # Seconds between flushes when buffering\nexport EZTRACE_SAMPLE_RATE=\"1.0\" # Global fixed sampling rate in [0.0, 1.0]\nexport EZTRACE_ADAPTIVE_SAMPLING=\"false\" # Keep slow/error traces at 100%, sample normal traces\nexport EZTRACE_ADAPTIVE_SLOW_THRESHOLD=\"1.0\" # Seconds; slow traces are always kept when adaptive is enabled\n</code></pre> <p>Set these before the first traced or logging use so they apply when the logger is created.</p>"},{"location":"configuration/#console-only-no-file-logging","title":"Console-only (no file logging)","text":"<pre><code>export EZTRACE_DISABLE_FILE_LOGGING=1\n</code></pre> <p>Or in code:</p> <pre><code>Setup.initialize(\"MyApp\", disable_file_logging=True)\n</code></pre>"},{"location":"configuration/#log-rotation","title":"Log rotation","text":"<p>Log files are rotated by size. Configure before first use:</p> <pre><code># In Setup.initialize()\nmax_size=10 * 1024 * 1024,  # 10MB per file\nbackup_count=5,              # Keep 5 rotated files\nlog_dir=\"logs\",\nlog_file=\"app.log\",\n</code></pre> <p>Env: <code>EZTRACE_MAX_SIZE</code>, <code>EZTRACE_BACKUP_COUNT</code>, <code>EZTRACE_LOG_DIR</code>, <code>EZTRACE_LOG_FILE</code>.</p>"},{"location":"configuration/#buffered-logging","title":"Buffered logging","text":"<p>When enabled, log records are buffered and flushed on interval or buffer full. Reduces I/O under high volume.</p> <ul> <li>Env: <code>EZTRACE_BUFFER_ENABLED=true</code>, <code>EZTRACE_BUFFER_FLUSH_INTERVAL=1.0</code></li> <li>Code: <code>Setup.initialize(..., buffer_enabled=True, buffer_flush_interval=1.0)</code></li> </ul> <p>Default is disabled. Set before the first traced/logging use.</p>"},{"location":"configuration/#redaction-env-defaults","title":"Redaction (env defaults)","text":"<pre><code>export EZTRACE_REDACT_KEYS=\"password,token,secret\"\nexport EZTRACE_REDACT_PATTERN=\"(?i)auth|secret\"\nexport EZTRACE_REDACT_VALUE_PATTERNS=\"secret\\d+\"\nexport EZTRACE_REDACT_PRESETS=\"pii,phi\"\n</code></pre> <p>For programmatic defaults, use <code>set_global_redaction()</code> \u2014 see Usage: Global redaction.</p>"},{"location":"configuration/#sampling","title":"Sampling","text":"<ul> <li>Global fixed sampling: <code>EZTRACE_SAMPLE_RATE</code> (float from <code>0.0</code> to <code>1.0</code>, default <code>1.0</code>)</li> <li>Global adaptive mode: <code>EZTRACE_ADAPTIVE_SAMPLING</code> (<code>true</code>/<code>false</code>, default <code>false</code>)</li> <li>Global adaptive slow threshold: <code>EZTRACE_ADAPTIVE_SLOW_THRESHOLD</code> (float seconds, <code>&gt;= 0.0</code>, default <code>1.0</code>)</li> </ul> <p>When adaptive sampling is enabled, slow/error traces are always kept; normal traces use the configured sample rate.</p>"},{"location":"contributing/","title":"Contributing","text":"<p>Contributions are welcome. Please read the Contributing Guidelines (CONTRIBUTING.md) in the repository for:</p> <ul> <li>Code of conduct</li> <li>How to submit pull requests</li> <li>Development and testing setup</li> </ul>"},{"location":"getting-started/","title":"Getting Started","text":""},{"location":"getting-started/#installation","title":"Installation","text":"<pre><code>pip install pyeztrace\n</code></pre> <p>Optional extras (library stays dependency-free by default):</p> Extra Purpose <code>pyeztrace[otel]</code> OpenTelemetry SDK and OTLP exporter <code>pyeztrace[gcp]</code> Google ADC auth for OTLP to Cloud Trace <code>pyeztrace[s3]</code> S3 exporter for span batches <code>pyeztrace[azure]</code> Azure Blob exporter <code>pyeztrace[all]</code> All optional dependencies <p>For the full test suite including OTEL coverage:</p> <pre><code>pip install \"pyeztrace[otel]\"\n</code></pre>"},{"location":"getting-started/#initialize-once-at-startup","title":"Initialize once at startup","text":"<p>Recommended: call <code>Setup.initialize(...)</code> before any traced code runs. Logging is configured once; doing this first gives predictable behavior.</p> <pre><code>from pyeztrace.setup import Setup\nfrom pyeztrace import trace\nfrom pyeztrace.custom_logging import Logging\n\nSetup.initialize(\n    \"MyApp\",\n    show_metrics=True,\n    log_format=\"json\",\n    log_file=\"app.log\",\n    log_dir=\"logs\",\n    disable_file_logging=False,\n)\nlog = Logging()\n</code></pre>"},{"location":"getting-started/#initialization-order","title":"Initialization order","text":"<ul> <li>Importing <code>trace</code> does not initialize setup; initialization is lazy on first use.</li> <li>For predictable behavior, either:</li> <li>Set environment variables before process start (e.g. <code>EZTRACE_LOG_DIR=logs</code>, <code>EZTRACE_LOG_FILE=app.log</code>), or</li> <li>Call <code>Setup.initialize(...)</code> before the first traced call.</li> </ul> <p>Configuration precedence (highest to lowest):</p> <ol> <li>Arguments passed to <code>Setup.initialize(...)</code></li> <li>Environment variables (<code>EZTRACE_*</code>)</li> <li>Built-in defaults</li> </ol>"},{"location":"getting-started/#quick-example","title":"Quick example","text":"<pre><code>@trace()\ndef process_order(order_id):\n    with log.with_context(order_id=order_id):\n        log.log_info(\"Processing order\")\n        validate_order(order_id)\n        log.log_info(\"Order processed successfully\")\n\n@trace()\ndef validate_order(order_id):\n    log.log_info(\"Validating order\")\n    # your logic\n</code></pre> <p>Example console output (with <code>log_format=\"color\"</code> or <code>\"plain\"</code>):</p> <pre><code>2025-05-13T10:00:00 - INFO - [MyApp] \u251c\u2500\u2500 process_order called...\n2025-05-13T10:00:00 - INFO - [MyApp] \u251c\u2500\u2500 Processing order Data: {order_id: \"123\"}\n2025-05-13T10:00:00 - INFO - [MyApp] \u2502    \u251c\u2500\u2500\u2500 validate_order called...\n2025-05-13T10:00:00 - INFO - [MyApp] \u2502    \u251c\u2500\u2500\u2500 validate_order Ok. (took 0.50 seconds)\n2025-05-13T10:00:01 - INFO - [MyApp] \u251c\u2500\u2500 process_order Ok. (took 1.23 seconds)\n</code></pre> <p>See Usage for tracing options, formats, CLI, and the interactive viewer.</p>"},{"location":"usage/","title":"Usage","text":""},{"location":"usage/#tracing-options","title":"Tracing options","text":"<p>Fine-grained control with the <code>@trace()</code> decorator:</p> <pre><code>@trace(\n    message=\"Custom trace message\",\n    stack=True,  # Include stack trace on errors\n    sample_rate=0.5,  # Optional local override for this trace\n    adaptive_sampling=True,  # Optional local adaptive override\n    adaptive_slow_threshold=0.25,  # Optional local slow-threshold override (seconds)\n    modules_or_classes=[my_module],\n    include=[\"specific_function_*\"],\n    exclude=[\"ignored_function_*\"],\n    recursive_depth=2,\n    module_pattern=\"myapp.*\",\n)\ndef function():\n    pass\n</code></pre>"},{"location":"usage/#sampling","title":"Sampling","text":"<p>Global env controls:</p> <ul> <li><code>EZTRACE_SAMPLE_RATE</code> (<code>0.0</code> to <code>1.0</code>, default <code>1.0</code>)</li> <li><code>EZTRACE_ADAPTIVE_SAMPLING</code> (<code>true</code>/<code>false</code>, default <code>false</code>)</li> <li><code>EZTRACE_ADAPTIVE_SLOW_THRESHOLD</code> (seconds, <code>&gt;= 0.0</code>, default <code>1.0</code>)</li> </ul> <p>Local override:</p> <pre><code>@trace(\n    sample_rate=1.0,            # Force this trace to always be kept\n    adaptive_sampling=True,     # Local adaptive mode override\n    adaptive_slow_threshold=0.1 # Local slow threshold override\n)\ndef critical_path():\n    pass\n</code></pre> <p>Adaptive mode keeps slow/error traces at 100% and samples normal traces using the configured rate.</p>"},{"location":"usage/#recursive-tracing","title":"Recursive tracing","text":"<p>Trace the function and functions in imported modules:</p> <pre><code>@trace(recursive_depth=1, module_pattern=\"myapp.*\")\ndef app_entry():\n    # Traces this and matching imported modules\n    pass\n</code></pre> <p>Use <code>module_pattern</code> to avoid tracing system or third-party code.</p>"},{"location":"usage/#redacting-sensitive-data","title":"Redacting sensitive data","text":"<pre><code>@trace(\n    redact_keys=[\"password\", \"token\"],\n    redact_value_patterns=[r\"secret\\d+\"],\n    redact_presets=[\"pii\"],\n)\ndef process(user, password, token):\n    return {\"user\": user, \"status\": \"ok\"}\n</code></pre> <p>Environment defaults: <code>EZTRACE_REDACT_KEYS</code>, <code>EZTRACE_REDACT_PATTERN</code>, <code>EZTRACE_REDACT_VALUE_PATTERNS</code>, <code>EZTRACE_REDACT_PRESETS</code>.</p>"},{"location":"usage/#context-management","title":"Context management","text":"<p>Thread-safe context propagation:</p> <pre><code>with log.with_context(user_id=\"123\", action=\"login\"):\n    log.log_info(\"User logged in\")  # Includes context\n\n    with log.with_context(session=\"abc\"):\n        log.log_info(\"Session started\")  # Inherits parent context\n</code></pre>"},{"location":"usage/#output-formats","title":"Output formats","text":"Format Use case <code>color</code> Default console; hierarchical tree <code>json</code> Machine-readable; required for the viewer <code>plain</code> Simple text <code>csv</code> Spreadsheet analysis <code>logfmt</code> System-style key=value <pre><code>log = Logging(log_format=\"json\")  # or \"color\", \"plain\", \"csv\", \"logfmt\"\n</code></pre> <p>Per-sink: set <code>console_format</code> and <code>file_format</code> via <code>Setup.initialize(..., console_format=\"color\", file_format=\"json\")</code> or env <code>EZTRACE_CONSOLE_LOG_FORMAT</code> / <code>EZTRACE_FILE_LOG_FORMAT</code>.</p>"},{"location":"usage/#interactive-viewer","title":"Interactive viewer","text":"<ol> <li>Enable JSON file logging (e.g. <code>Setup.initialize(..., file_format=\"json\", disable_file_logging=False)</code>).</li> <li>Run your app to produce logs.</li> <li>Start the viewer:</li> </ol> <pre><code>pyeztrace serve logs/app.log --host 127.0.0.1 --port 8765\n</code></pre> <p>Open <code>http://127.0.0.1:8765</code>. You get:</p> <ul> <li>Hierarchical tree (parent/child calls)</li> <li>Input/output previews, duration, CPU, memory</li> <li>Filters (function, error, min duration), auto-refresh</li> </ul> <p>Note: The trace viewer UI (<code>pyeztrace serve</code>) is designed for local development and analysis\u2014it is not intended to be used as a hosted or production solution.</p>"},{"location":"usage/#async-support","title":"Async support","text":"<pre><code>@trace()\nasync def async_handler():\n    await some_async_work()\n    log.log_info(\"Done\")\n</code></pre> <p>Setup and level tracking are async-safe.</p>"},{"location":"usage/#redirecting-print-to-logging","title":"Redirecting <code>print</code> to logging","text":"<pre><code>from pyeztrace import print  # noqa: A001\n\nSetup.initialize(\"MyApp\")\nprint(\"Hello\")                      # INFO\nprint(\"Warning\", level=\"WARNING\")  # WARNING\n</code></pre> <p>Falls back to built-in <code>print</code> if EzTrace is not initialized or when writing to a custom file.</p>"},{"location":"usage/#performance-metrics","title":"Performance metrics","text":"<pre><code>Setup.initialize(\"MyApp\", show_metrics=True)\n\n@trace()\ndef monitored():\n    pass\n</code></pre> <p>At exit, a summary is printed: calls, total time, average per function.</p>"},{"location":"usage/#error-handling","title":"Error handling","text":"<pre><code>log.log_debug(\"Debug\")\nlog.log_info(\"Info\")\nlog.log_warning(\"Warning\")\nlog.log_error(\"Error\")\n\ntry:\n    risky()\nexcept Exception as e:\n    log.raise_exception_to_log(e, \"Custom message\", stack=True)\n</code></pre>"},{"location":"usage/#applying-trace-to-classes","title":"Applying <code>@trace</code> to classes","text":"<p>Decorate a class to trace all its methods (including <code>__init__</code>):</p> <pre><code>from pyeztrace import trace\n\n@trace()\nclass MyService:\n    def __init__(self, name):\n        self.name = name\n\n    def process(self, data):\n        return data.upper()\n\n    def analyze(self, data):\n        return len(data)\n</code></pre> <p>Each method gets full tracing (start/end, duration, args/result preview).</p>"},{"location":"usage/#double-tracing-prevention","title":"Double-tracing prevention","text":"<p>PyEzTrace avoids duplicate trace entries when:</p> <ul> <li>A function is decorated with <code>@trace</code> and also called from another traced function</li> <li>A class is decorated and also traced via recursive tracing</li> <li>The same function is traced from multiple parent functions (recursive tracing)</li> </ul> <p>Only one trace is emitted per call, so logs stay clean while coverage stays full.</p>"},{"location":"usage/#thread-safe-high-volume-logging","title":"Thread-safe high-volume logging","text":"<p>The logger and tracer are thread-safe. Example with a thread pool:</p> <pre><code>from concurrent.futures import ThreadPoolExecutor\nfrom pyeztrace import trace\nfrom pyeztrace.custom_logging import Logging\n\nlog = Logging()\n\n@trace()\ndef worker(worker_id):\n    with log.with_context(worker_id=worker_id):\n        log.log_info(\"Started\")\n        # ... work ...\n        log.log_info(\"Finished\")\n\nwith ThreadPoolExecutor(max_workers=5) as executor:\n    executor.map(worker, range(5))\n</code></pre>"},{"location":"usage/#global-redaction-programmatic","title":"Global redaction (programmatic)","text":"<p>Set default redaction for all traces in code:</p> <pre><code>from pyeztrace import set_global_redaction\n\nset_global_redaction(\n    redact_keys=[\"password\", \"token\"],\n    redact_pattern=r\"(?i)secret\",\n    redact_value_patterns=[r\"secret\\d+\"],\n    presets=[\"pii\"],\n)\n</code></pre> <p>Same options as per-decorator <code>redact_keys</code>, <code>redact_pattern</code>, <code>redact_value_patterns</code>, and <code>redact_presets</code>.</p>"},{"location":"usage/#cli","title":"CLI","text":"Command Description <code>pyeztrace serve &lt;log_file&gt;</code> Start the interactive trace viewer (default: http://127.0.0.1:8765) <code>pyeztrace print &lt;log_file&gt;</code> Print or filter log entries from a file <p>Viewer:</p> <pre><code>pyeztrace serve logs/app.log --host 127.0.0.1 --port 8765\n</code></pre> <p>Optional env: <code>EZTRACE_VIEW_HOST</code>, <code>EZTRACE_VIEW_PORT</code>.</p> <p>Print / analyze logs:</p> <pre><code>pyeztrace print logs/app.log\npyeztrace print logs/app.log --analyze\npyeztrace print logs/app.log --function my_func --format json\n</code></pre> <p>Use <code>--level</code>, <code>--since</code>, <code>--until</code> to filter. <code>--analyze</code> shows performance metrics; <code>--function</code> limits analysis to that function.</p>"},{"location":"usage/#opentelemetry-optional","title":"OpenTelemetry (optional)","text":"<p>Install: <code>pip install \"pyeztrace[otel]\"</code>. Enable with environment variables.</p> <p>OTLP (collector):</p> <pre><code>export EZTRACE_OTEL_ENABLED=true\nexport EZTRACE_OTEL_EXPORTER=otlp\nexport EZTRACE_OTLP_ENDPOINT=\"http://localhost:4318/v1/traces\"\n# optional: export EZTRACE_SERVICE_NAME=\"my-service\"\n</code></pre> <p>Google Cloud Trace (OTLP + ADC):</p> <pre><code>pip install \"pyeztrace[otel,gcp]\"\nexport EZTRACE_OTEL_ENABLED=true\nexport EZTRACE_OTEL_EXPORTER=gcp\n# optional override; defaults to telemetry endpoint for exporter=gcp\nexport EZTRACE_OTLP_ENDPOINT=\"https://telemetry.googleapis.com/v1/traces\"\n# optional explicit toggle\nexport EZTRACE_OTLP_GCP_AUTH=true\n</code></pre> <p>If Cloud Trace returns <code>Resource is missing required attribute \"gcp.project_id\"</code>, set: <code>EZTRACE_GCP_PROJECT_ID</code> (or <code>GOOGLE_CLOUD_PROJECT</code> / <code>GCLOUD_PROJECT</code> / <code>GCP_PROJECT</code>).</p> <p>Console (local dev):</p> <pre><code>export EZTRACE_OTEL_ENABLED=true\nexport EZTRACE_OTEL_EXPORTER=console\n</code></pre> <p>S3 / Azure: Install <code>pyeztrace[s3]</code> or <code>pyeztrace[azure]</code>, set <code>EZTRACE_OTEL_EXPORTER=s3</code> or <code>azure</code>, and the bucket/container and credential env vars. See the README OpenTelemetry section for full S3/Azure options.</p> <p>The bridge is lazy-loaded; if OTEL packages are missing, the library still works without spans. Spans use function <code>__qualname__</code>; exceptions are recorded on the active span.</p> <p>For troubleshooting, enable OTEL diagnostics:</p> <pre><code>export EZTRACE_OTEL_DEBUG=true\n</code></pre> <p>And inspect runtime OTEL state in code:</p> <pre><code>from pyeztrace import otel\nprint(otel.get_otel_status())\n</code></pre> <p><code>otel.get_otel_status()</code> is available in newer builds after <code>0.1.1</code>.</p>"}]}